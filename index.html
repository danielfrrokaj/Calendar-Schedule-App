<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shto Kurset</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
</head>
<body>
    <div class="header-section">
        <h1 class="header-title">Orari akademik ne kalendar ics</h1>
        <p class="header-subtitle">Shto orarin e lendeve ne kalendarin e telefonit tuaj</p>
    </div>

    <div class="main-container">
        <div class="icon-container">
            <div class="calendar-icon">
                <div class="calendar-month"></div>
                <div class="calendar-day"></div>
            </div>
        </div>

        <h2 class="page-title">Shto Lëndët</h2>
        
        <div id="coursesContainer">
            <!-- Course forms will be added here dynamically -->
        </div>

        <div class="actions-container">
            <button type="button" class="btn btn-success btn-add-course" id="addCourseBtn">
                <i class="bi bi-plus-lg"></i> Shto Lëndë tjetër
            </button>
            <button type="button" class="btn btn-primary" id="nextBtn">Vazhdo</button>
        </div>
    </div>

    <template id="courseTemplate">
        <div class="course-container">
            <div class="course-header">
                <span class="course-number"></span>
                <div class="remove-course">
                    <i class="bi bi-x-circle-fill"></i>
                </div>
            </div>
            <form class="course-form">
                <div class="row g-3">
                    <div class="col-md-6">
                        <label class="form-label">Emri i lëndës *</label>
                        <input type="text" class="form-control course-name" required>
                        <div class="error-feedback">Ju lutem plotësoni emrin e lëndës</div>
                    </div>
                    
                    <div class="col-md-6">
                        <label class="form-label">Dita *</label>
                        <select class="form-select course-day" required>
                            <option value="">Zgjidhni ditën</option>
                            <option value="E Hënë">E Hënë</option>
                            <option value="E Martë">E Martë</option>
                            <option value="E Mërkurë">E Mërkurë</option>
                            <option value="E Enjte">E Enjte</option>
                            <option value="E Premte">E Premte</option>
                            <option value="E Shtunë">E Shtunë</option>
                            <option value="E Diel">E Diel</option>
                        </select>
                        <div class="error-feedback">Ju lutem zgjidhni një ditë</div>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Ora *</label>
                        <input type="time" class="form-control course-start-time" required>
                        <div class="error-feedback">Ju lutem zgjidhni orën e fillimit</div>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Mbarimi i Orës *</label>
                        <input type="time" class="form-control course-end-time" required>
                        <div class="error-feedback">Ju lutem zgjidhni orën e mbarimit</div>
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Pedagogu</label>
                        <input type="text" class="form-control course-professor">
                    </div>

                    <div class="col-md-6">
                        <label class="form-label">Dhoma *</label>
                        <input type="text" class="form-control course-room" required>
                        <div class="error-feedback">Ju lutem plotësoni dhomën</div>
                    </div>
                </div>
            </form>
        </div>
    </template>

    <footer class="footer-section">
        <div class="container">
            <h3 class="faq-title">Pyetje të Shpeshta</h3>
            <div class="accordion" id="faqAccordion">
                <!-- FAQ Item 1 -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                            Si ta importoj skedarin .ics në telefonin tim?
                        </button>
                    </h2>
                    <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Pasi të shkarkoni skedarin .ics, hapeni atë në telefonin tuaj. Sistemi do t'ju pyesë se në cilën aplikacion të kalendarit dëshironi ta hapni. Zgjidhni aplikacionin tuaj të preferuar të kalendarit (Google Calendar, Apple Calendar, etj.) dhe të gjitha ngjarjet do të shtohen automatikisht në kalendarin tuaj.
                        </div>
                    </div>
                </div>

                <!-- FAQ Item 2 -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                            A mund t'i modifikoj lëndët pasi t'i kem importuar?
                        </button>
                    </h2>
                    <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Po, pasi lëndët të importohen në kalendarin tuaj, mund t'i modifikoni si çdo ngjarje tjetër të kalendarit. Mund të ndryshoni kohën, vendndodhjen, të shtoni alarme ose detaje shtesë sipas nevojës suaj.
                        </div>
                    </div>
                </div>

                <!-- FAQ Item 3 -->
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                            A do të përditësohet kalendari im automatikisht nëse ka ndryshime në orar?
                        </button>
                    </h2>
                    <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                        <div class="accordion-body">
                            Jo, skedari .ics krijon një import të njëhershëm të lëndëve. Nëse ka ndryshime në orar, do t'ju duhet të gjeneroni dhe importoni një skedar të ri .ics. Rekomandojmë të fshini ngjarjet e vjetra përpara se të importoni orarin e ri për të shmangur dublikimin.
                        </div>
                    </div>
                </div>
            </div>
            <div class="developer-credit">
                <p>
                    Developed by Danjel Frrokaj
                    <a href="https://github.com/danielfrrokaj" class="github-link" target="_blank" rel="noopener noreferrer">
                        <i class="bi bi-github"></i>
                    </a>
                </p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Store all courses
        let courses = [];
        let courseCount = 0;

        // Get DOM elements
        const coursesContainer = document.getElementById('coursesContainer');
        const addCourseBtn = document.getElementById('addCourseBtn');
        const nextBtn = document.getElementById('nextBtn');
        const courseTemplate = document.getElementById('courseTemplate');

        // Add new course form
        function addCourseForm() {
            courseCount++;
            const courseElement = courseTemplate.content.cloneNode(true);
            
            // Set course number
            courseElement.querySelector('.course-number').textContent = `Kursi ${courseCount}`;
            
            // Add form validation listeners
            const form = courseElement.querySelector('.course-form');
            const inputs = form.querySelectorAll('input[required], select[required]');
            inputs.forEach(input => {
                input.addEventListener('input', validateInput);
                input.addEventListener('blur', validateInput);
            });

            // Add time validation
            const startTime = form.querySelector('.course-start-time');
            const endTime = form.querySelector('.course-end-time');
            [startTime, endTime].forEach(input => {
                input.addEventListener('change', () => validateTimeRange(startTime, endTime));
            });

            // Add remove functionality
            const removeBtn = courseElement.querySelector('.remove-course');
            removeBtn.addEventListener('click', function() {
                const container = this.closest('.course-container');
                if (coursesContainer.children.length > 1) {
                    container.style.opacity = '0';
                    container.style.transform = 'translateY(20px)';
                    setTimeout(() => {
                        container.remove();
                        updateCourseNumbers();
                    }, 300);
                } else {
                    showError('Duhet të keni të paktën një kurs!');
                }
            });

            coursesContainer.appendChild(courseElement);
        }

        // Update course numbers after removal
        function updateCourseNumbers() {
            const containers = coursesContainer.querySelectorAll('.course-container');
            containers.forEach((container, index) => {
                container.querySelector('.course-number').textContent = `Kursi ${index + 1}`;
            });
            courseCount = containers.length;
        }

        // Validate individual input
        function validateInput(event) {
            const input = event.target;
            const isValid = input.checkValidity();
            input.classList.toggle('is-invalid', !isValid);
        }

        // Validate time range
        function validateTimeRange(startInput, endInput) {
            const startTime = startInput.value;
            const endTime = endInput.value;

            if (startTime && endTime) {
                const isValid = startTime < endTime;
                endInput.classList.toggle('is-invalid', !isValid);
                if (!isValid) {
                    endInput.nextElementSibling.textContent = 'Ora e mbarimit duhet të jetë pas orës së fillimit';
                }
                return isValid;
            }
            return true;
        }

        // Show error message
        function showError(message) {
            const errorDiv = document.createElement('div');
            errorDiv.className = 'alert alert-danger alert-dismissible fade show';
            errorDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            document.querySelector('.main-container').insertBefore(errorDiv, coursesContainer);
            setTimeout(() => errorDiv.remove(), 5000);
        }

        // Collect and validate course data
        function collectCourseData() {
            const courseForms = document.querySelectorAll('.course-form');
            let isValid = true;
            let newCourses = [];

            courseForms.forEach(form => {
                // Validate all required fields
                const requiredInputs = form.querySelectorAll('[required]');
                requiredInputs.forEach(input => {
                    const valid = input.checkValidity();
                    input.classList.toggle('is-invalid', !valid);
                    if (!valid) isValid = false;
                });

                // Validate time range
                const startTime = form.querySelector('.course-start-time');
                const endTime = form.querySelector('.course-end-time');
                if (!validateTimeRange(startTime, endTime)) {
                    isValid = false;
                }

                if (!isValid) return;

                // Collect data
                newCourses.push({
                    courseName: form.querySelector('.course-name').value.trim(),
                    day: form.querySelector('.course-day').value,
                    startTime: startTime.value,
                    endTime: endTime.value,
                    professor: form.querySelector('.course-professor').value.trim(),
                    room: form.querySelector('.course-room').value.trim()
                });
            });

            if (isValid) {
                courses = newCourses;
                return true;
            }
            showError('Ju lutem korrigjoni gabimet në formular.');
            return false;
        }

        // Event Listeners
        addCourseBtn.addEventListener('click', addCourseForm);

        nextBtn.addEventListener('click', function() {
            if (collectCourseData()) {
                localStorage.setItem('courseData', JSON.stringify(courses));
                window.location.href = 'semester-end.html';
            }
        });

        // Add initial course form
        addCourseForm();

        // Update calendar icon with current date
        function updateCalendarIcon() {
            const months = ['Jan', 'Shk', 'Mar', 'Pri', 'Maj', 'Qer', 
                          'Kor', 'Gus', 'Sht', 'Tet', 'Nën', 'Dhj'];
            const now = new Date();
            const month = months[now.getMonth()];
            const day = now.getDate();

            document.querySelector('.calendar-month').textContent = month;
            document.querySelector('.calendar-day').textContent = day;
        }

        // Call it when page loads
        updateCalendarIcon();
    </script>
</body>
</html> 